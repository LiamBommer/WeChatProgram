<!--pages/Project/Task/TaskDetail/TaskDetail.wxml-->
<view>
  <!-- 标题 -->
  <view class="view-container">
     <view class='title-view ver-align space-between'>
       <view class='title'>
          <checkbox class='item-checkbox'/>
          <input class='title-text' value='{{title}}' />
       </view>
       <button class='share' hover-class="share-hover"  open-type="share"><image src='{{icon_share}}'></image></button>
       
     </view>
  </view>

  <!-- 内容 -->
  <view class="view-container">

    <view class="item-view" bindtap='MemberList'>
      <image class='header' src='{{icon_person}}'></image>
      <image src='{{icon_person}}'></image>
      <image src='{{icon_person}}'></image>
    </view>

    <view class="item-view">
      <image src='{{icon_deadline}}'></image>
      <view class='desc'>
        <picker mode="date" value="{{deadline}}" bindchange="DeadLineChange">
          <view class="picker">
            {{deadline}} 截止
          </view>
        </picker>
      </view>
    </view>
    <view class="item-view">
      <image src='{{icon_project}}'></image>
      <text class='desc'>鲨鱼派对/项目名</text>
    </view>

    <!-- 添加内容 -->
    <view class="item-view" bindtap='addMorecontent'>
      <image src='{{icon_add}}'></image>
      <text class='desc'>添加更多内容</text>
    </view>
    
    <!-- 内容隐藏 -->
    <view style='display:{{show? "" : "none"}}'>
    <scroll-view style="height: 200px;" >
        <view class="scroll-view-item item-view">
          <image src='/img/alarm.png'></image>
          <view class='desc'>
              <picker mode="date" value="{{remindtime}}" bindchange="RemindTimeChange">
                <view class="picker">
                  {{remindtime}} 提醒
                </view>
              </picker>
          </view>
        </view>

        <view class="scroll-view-item item-view">
          <image src='/img/feedback_time.png'></image>
          <view class='desc'>
              <picker mode="date" value="{{feedbacktime}}" bindchange="FeedBacktimeChange">
                <view class="picker">
                  {{feedbacktime}} 反馈
                </view>
              </picker>
          </view>
        </view>

        <view class="scroll-view-item item-view" bindtap='Feedback'>
          <image src='/img/feedback_model.png'></image>
          <text class='desc'>反馈模板</text>
        </view>

        <view class="scroll-view-item item-view" bindtap='Describe'>
          <image src='/img/task_description.png'></image>
          <text class='desc'>任务描述</text>
        </view>
  </scroll-view>
    </view>

    <view class="item-view delete">
      <image src='{{icon_close}}'></image>
      <view class='desc delete-text' bindtap='DeleteTask'>删除任务</view>
    </view>

    <view class="item-view ver-align space-between">
      <view class='ver-align'>
        <image src='{{icon_task_list}}'></image>
        <text class='desc'>子任务</text>
      </view>
      <image src='{{icon_add}}' bindtap='AddChildTask'></image>
    </view>
    
    <block wx:for="{{ChildTask}}">
      <view class="item-view ver-align space-between" bindtap='ChildTaskDetail'>
        <view class='childtask'>
          <checkbox class='item-checkbox'/>
          <text >{{item.name}}</text>
        </view>
        <image src='{{item.icon}}'></image>
      </view>
    </block>
   </view>

  <!-- 聊天框 -->
  <view class='chat'>
     <scroll-view style="height: 400px;" scroll-y scroll-into-view="{{toView}}" scroll-top="{{scrollTop}}" >
        <!-- 任务消息 -->
        <block wx:for = "{{taskremind}}">
            <view class='taskremind' id="remind{{index}}">
                <view class='text'>{{item.text}}</view>
                <view class='time'>{{item.time}}</view>
            </view>
        </block>
        
        <!-- 信息框 -->
        <block wx:for = "{{chat}}">
            <block wx:if = "{{item.judgemine}}">
              <block wx:if = "{{item.judgepictrue}}">
                  <!-- 图片信息框（我发送） -->
                  <view class='chatperson-me' id="chat{{index}}">
                      <image class='content-img' src="{{item.content}}" data-index='{{index}}' bindtap='previewImage'></image> 
                      <image class='person-icon' src='{{item.icon}}'></image>
                  </view>
              </block>
              <block wx:else>
                  <!-- 文字信息框（我发送） -->
                  <view class='chatperson-me' id="chat{{index}}" data-index='{{index}}' >
                      <text class='content'>{{item.content}}</text>
                      <image class='person-icon' src='{{item.icon}}'></image>
                  </view>
              </block>
            </block>
            <block wx:else>
              <block wx:if = "{{item.judgepictrue}}">
                  <!-- 图片信息框（其他人发送） -->
                  <view class='chatperson' id="chat{{index}}" data-index='{{index}}' >
                      <image class='person-icon' src='{{item.icon}}'></image>
                      <image class='content-img' src="{{item.content}}" data-index='{{index}}' bindtap='previewImage'></image> 
                  </view>
                </block>
                <block wx:else>
                  <!-- 文字信息框（其他人发送） -->
                  <view class='chatperson' id="chat{{index}}" data-index='{{index}}' >
                    <image class='person-icon' src='{{item.icon}}'></image>
                    <text class='content'>{{item.content}}</text>
                  </view>
                </block>
              </block>
          </block> 
     </scroll-view>

     <!-- 输入框 -->
     <view class='input'>
        <image class='template-icon' bindtap='ClickCommModel' src='/img/communication_model.png'></image>
        <textarea fixed type='text' placeholder='在此输入文字...' bindtap='ClickInput' bindconfirm="ChatInput" value='{{Inputcontent}}'></textarea>
        <image class='face-icon' src='/img/expression.png'></image>
        <image class='picture-icon' src='/img/picture.png' bindtap='PictrueSelect'></image>
     </view>
  </view>
</view>

